# 펭귄 홈트레이닝 21일 챌린지 앱 기획 및 기술 설계서

## 1. 스티치 mcp (UI/UX 디자인): 전문적인 기준 및 사용자 경험 설계

성공적인 피트니스 앱은 디자인이 단순히 예쁜 것을 넘어 사용자가 몰입(Flow)하고 동기를 부여받도록 설계되어야 합니다.

*   **빠르고 마찰 없는 온보딩 (Fast & Frictionless Onboarding):**
    *   가입 후 60초 이내에 목표를 설정하고 첫 운동 영상으로 진입할 수 있도록 단계를 최소화해야 합니다.
    *   "시작하기 💪"와 같은 동기부여 마이크로카피를 사용하고, 스마트 기본값(예: '하루 15분', '다이어트')을 제공하여 사용자 이탈을 방지합니다.
*   **펭귄 다마고치 (디지털 펫) UI/UX:**
    *   **비경쟁적 동기부여:** 다른 사용자와의 경쟁(리더보드 등)보다는 펭귄 캐릭터에 대한 헌신과 유대감을 통해 동기를 부여합니다. 사용자가 운동을 기록할 때마다 펭귄과의 '친밀도(Friendship level)'가 상승하며, 이에 따라 새로운 대화나 상호작용이 해금됩니다.
    *   **상태 시각화 및 마이크로 인터랙션:** 펭귄의 기분(행복, 슬픔, 배고픔)이 시간에 따라 변하며 운동을 통해 긍정적인 상태로 회복되도록 설계합니다. 펭귄을 터치할 때 '바운스(Bounce)' 애니메이션을 추가하여 앱이 살아있는 듯한 피드백을 제공합니다.
*   **운동 영상 시청 (몰입을 위한 Flow-friendly UI):**
    *   운동 중에는 방해 요소(팝업, 네비게이션 바 등)를 제거하고, 커다란 타이머와 현재/다음 동작에만 집중할 수 있는 깔끔한 UI를 제공합니다.
    *   화면을 보지 않고도 운동할 수 있도록 오디오 및 진동 피드백을 활용합니다.
*   **21일 챌린지 추적 (진척도 시각화):**
    *   연속 달성일(Streak), 달성 배지, 주간/월간 목표 달성 그래프를 대시보드에 배치하여 사용자의 노력이 시각적인 성취감으로 이어지도록 합니다.
    *   챌린지 달성 시 폭죽(Confetti)이나 파동(Pulse) 효과 같은 마이크로 인터랙션과 함께 사운드/진동 피드백을 제공합니다.

## 2. 파이어베이스 mcp: 백엔드 및 인프라 설계서

크로스 플랫폼(iOS, Android, Web) 동시 런칭을 위해 Firebase를 핵심 백엔드로 활용합니다.

*   **회원가입 및 인증 (Authentication):**
    *   Firebase Authentication을 사용하여 간편한 소셜 로그인(Google, Apple 등) 및 이메일 인증을 구현하여 글로벌 사용자의 진입 장벽을 낮춥니다.
*   **데이터베이스 스키마 (Cloud Firestore):**
    *   **User Collection:** 사용자 기본 정보, 21일 챌린지 진행 상태(현재 일차, 연속 달성일), 누적 운동 기록.
    *   **Penguin_State Collection:** 펭귄의 현재 기분(mood), 마지막 상호작용 시간(last interactions), 사용자가 지어준 이름(name), 친밀도 레벨.
    *   **Workout_Logs Collection:** 시청한 비디오 ID, 운동 완료 시간, 소모 칼로리 등을 기록합니다.
*   **푸시 알림 (Firebase Cloud Messaging - FCM):**
    *   사용자의 21일 습관 형성을 위해 매일 일정한 시간에 푸시 알림이 필요합니다.
    *   Firebase Cloud Functions와 Google Cloud Pub/Sub (Cloud Scheduler)를 결합하여 Cron 스크립트를 작성합니다. 이를 통해 매일 지정된 시간에 사용자별 맞춤형(예: "펭귄이 운동을 기다리고 있어요!") 알림을 자동 전송합니다.
*   **글로벌 배포 (Hosting & Distribution):**
    *   웹 버전은 Firebase Hosting을 통해 배포하며, 앱 배포 전 테스트를 위해 Firebase App Distribution을 활용합니다.

## 3. 안티그래비티: React 크로스 플랫폼 개발 가이드

React Native(웹 연동 시 React Native for Web 또는 Expo) 프레임워크를 기반으로 모바일 및 웹 통합 환경을 구축합니다.

*   **상태 관리 (State Management) 및 영속성:**
    *   전역 상태 관리 라이브러리(예: Zustand)를 사용하여 비즈니스 로직과 UI를 분리합니다. 펭귄의 기분, 대화 진행도 등을 상태로 관리합니다.
    *   앱을 종료하더라도 펭귄이 사용자를 '기억'할 수 있도록 로컬 스토리지(AsyncStorage 등)를 활용해 펭귄의 상태와 이름을 유지시킵니다.
*   **영상 스트리밍 구현 방안:**
    *   글로벌 사용자가 지연 없이 영상을 시청할 수 있도록 전용 CDN을 구축하여 콘텐츠를 안전하게 전송합니다.
    *   주문형 비디오(VOD) 방식으로 운동 영상을 제공하며 플랫폼 간 끊김 없는 재생을 지원해야 합니다.
*   **펭귄 애니메이션 (디지털 펫) 구현:**
    *   벡터 확장성이 뛰어나고 파일 크기가 작은 SVG 애니메이션을 활용합니다.
    *   React Native SVG와 `Reanimated 3` 라이브러리를 결합하여 펭귄을 쓰다듬거나 밥을 줄 때의 제스처 기반 상호작용과 부드러운 애니메이션(60 FPS)을 최적화하여 구현합니다.

## 4. 페이팔: 글로벌 결제 아키텍처 및 구현 설계서

글로벌 시장 구독 및 인앱 결제를 처리하기 위해 클라이언트 조작을 방지하는 서버 사이드 기반의 결제 아키텍처를 설계합니다.

*   **구독 및 인앱결제 아키텍처 Flow:**
    1.  **클라이언트 요청:** React 앱(프론트엔드)에서 사용자가 프리미엄 21일 챌린지 또는 펭귄 특별 아이템 구매를 요청하면 Firebase Cloud Functions를 호출합니다. 이때 클라이언트에서 가격을 보내면 변조 위험이 있으므로, 사용자 UID와 구매하려는 항목의 ID만 전송합니다.
    2.  **결제 세션 생성:** Cloud Function이 요청을 받아 수량을 계산하고, PayPal 서버로 결제 페이지(Payment intent)를 요청하여 클라이언트로 반환합니다.
    3.  **결제 진행 및 Webhook 수신:** 사용자가 결제를 완료하면 PayPal에서 Firebase Cloud Function(Webhook Handler)으로 Webhook을 전송합니다.
    4.  **서명 검증 (보안):** 해커의 Webhook 악용을 막기 위해, PayPal이 제공하는 API를 통해 수신된 Webhook 데이터의 서명(Signature)이 실제 PayPal에서 보낸 것이 맞는지 반드시 검증해야 합니다.
    5.  **DB 업데이트 (Fulfillment):** 검증이 완료되면 전달받은 UID를 조회하여 Firestore의 사용자 권한(구독 활성화, 아이템 추가 등)을 업데이트합니다.
